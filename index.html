<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Paradise</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0,-30px,0); }
            70% { transform: translate3d(0,-15px,0); }
            90% { transform: translate3d(0,-4px,0); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-bounce { animation: bounce 1s infinite; }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        .animate-spin { animation: spin 1s linear infinite; }
        
        .gradient-bg-1 { background: linear-gradient(to right, #fbbf24, #f97316); }
        .gradient-bg-2 { background: linear-gradient(to right, #fbbf24, #ec4899, #8b5cf6); }
        .gradient-bg-3 { background: linear-gradient(to right, #f87171, #4ade80, #3b82f6); }
        .gradient-bg-4 { background: linear-gradient(to right, #8b5cf6, #ec4899); }
        .gradient-bg-5 { background: linear-gradient(to right, #fbbf24, #f97316); }
        
        /* Icons using CSS shapes and Unicode */
        .icon {
            display: inline-block;
            width: 24px;
            height: 24px;
            text-align: center;
            line-height: 24px;
            font-size: 18px;
        }
        .icon-large {
            width: 32px;
            height: 32px;
            line-height: 32px;
            font-size: 24px;
        }
        .icon-xl {
            width: 64px;
            height: 64px;
            line-height: 64px;
            font-size: 48px;
        }
    </style>
</head>
<body class="bg-gradient-to-b from-green-50 to-blue-50 min-h-screen">
    <div id="app" class="max-w-6xl mx-auto p-6">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-green-800 mb-2">Plant Paradise</h1>
            <p class="text-green-600">Collect magical plants from seed packs!</p>
            
            <div class="flex justify-center items-center gap-4 mt-4">
                <div class="bg-white rounded-lg px-4 py-2 shadow-md">
                    <div class="flex items-center gap-2">
                        <span class="icon text-blue-500">‚ú®</span>
                        <span class="font-bold text-lg" id="nectarDisplay">50 Nectar</span>
                    </div>
                </div>
                <div class="bg-white rounded-lg px-4 py-2 shadow-md">
                    <div class="flex items-center gap-2">
                        <span class="icon text-yellow-500">‚≠ê</span>
                        <span class="font-bold text-lg" id="sunlightDisplay">0 Sunlight</span>
                    </div>
                </div>
                <div class="bg-white rounded-lg px-4 py-2 shadow-md">
                    <span class="font-bold text-lg text-green-600" id="nectarPerSecDisplay">+0/sec</span>
                </div>
            </div>

            <div id="milestoneProgress" class="mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3 hidden">
                <div class="text-sm text-yellow-700" id="milestoneText"></div>
                <div class="text-xs text-yellow-600" id="milestoneProgress"></div>
                <div class="w-full bg-yellow-200 rounded-full h-2 mt-2">
                    <div id="milestoneBar" class="bg-yellow-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <!-- Reward Popup -->
        <div id="rewardPopup" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 animate-bounce hidden">
            <div id="rewardContent" class="rounded-xl p-6 shadow-2xl border-4 border-yellow-400">
                <div class="text-center text-white" id="rewardText"></div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="bg-white rounded-xl shadow-lg mb-8">
            <!-- Tabs -->
            <div class="flex border-b border-gray-200">
                <button id="farmTab" class="flex-1 py-4 px-6 text-lg font-semibold transition-colors bg-yellow-100 text-yellow-800 border-b-2 border-yellow-500">
                    Farm (0 ready)
                </button>
                <button id="generatorsTab" class="flex-1 py-4 px-6 text-lg font-semibold transition-colors text-gray-600 hover:text-purple-600">
                    Generators (+0/sec)
                </button>
                <button id="collectionTab" class="flex-1 py-4 px-6 text-lg font-semibold transition-colors text-gray-600 hover:text-blue-600">
                    Collection (0)
                </button>
                <button id="shopTab" class="flex-1 py-4 px-6 text-lg font-semibold transition-colors text-gray-600 hover:text-green-600">
                    Shop
                </button>
            </div>

            <!-- Tab Content -->
            <div class="p-6">
                <!-- Farm Tab -->
                <div id="farmContent" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h2 class="text-2xl font-bold text-green-800 mb-4">Garden Plots</h2>
                        <div class="grid grid-cols-4 gap-3 mb-4" id="gardenSlots"></div>
                        <div class="text-sm text-gray-600 text-center">
                            Plants grow over time. Ready plants appear in the harvest section!
                        </div>
                    </div>

                    <div>
                        <h2 class="text-2xl font-bold text-yellow-800 mb-4">Ready to Harvest</h2>
                        <div class="space-y-3 max-h-96 overflow-y-auto" id="harvestList"></div>
                        <button id="harvestAllBtn" class="w-full mt-4 py-3 bg-yellow-500 hover:bg-yellow-600 text-white font-bold rounded-lg transition-colors hidden">
                            Harvest All (0)
                        </button>
                    </div>
                </div>

                <!-- Generators Tab -->
                <div id="generatorsContent" class="hidden">
                    <h2 class="text-2xl font-bold text-purple-800 mb-4">Nectar Generators</h2>
                    <p class="text-gray-600 mb-6">Build generators that automatically produce nectar over time!</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="generatorsList"></div>
                    <div id="generatorSummary" class="mt-8 bg-gradient-to-r from-purple-100 to-blue-100 rounded-xl p-6"></div>
                </div>

                <!-- Collection Tab -->
                <div id="collectionContent" class="hidden">
                    <h2 class="text-2xl font-bold text-blue-800 mb-4">Plant Collection</h2>
                    <div id="collectionGrid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"></div>
                </div>

                <!-- Shop Tab -->
                <div id="shopContent" class="hidden grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h2 class="text-2xl font-bold text-green-800 mb-4">Seed Packs</h2>
                        <div class="space-y-4" id="seedPacksList"></div>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-yellow-600 mb-4">Sunlight Shop</h2>
                        <div class="space-y-3" id="sunlightShopList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            nectar: 50,
            sunlight: 0,
            plantCollection: {},
            activeSlots: {},
            openingPack: null,
            lastReward: null,
            activeTab: 'farm',
            lastMilestoneReached: 0,
            generators: {
                sprinkler: { level: 0, cost: 100, baseNectar: 2 },
                greenhouse: { level: 0, cost: 500, baseNectar: 8 },
                beehive: { level: 0, cost: 2000, baseNectar: 25 },
                mysticwell: { level: 0, cost: 10000, baseNectar: 75 }
            }
        };

        // Plant Data
        const plantTypes = {
            daisy: { name: 'Daisy', icon: 'üåº', rarity: 'common', color: 'text-white', bgColor: 'bg-gray-400', growthTime: 10000, harvestReward: 15 },
            grass: { name: 'Grass', icon: 'üå±', rarity: 'common', color: 'text-white', bgColor: 'bg-gray-500', growthTime: 8000, harvestReward: 12 },
            clover: { name: 'Clover', icon: 'üçÄ', rarity: 'common', color: 'text-white', bgColor: 'bg-gray-600', growthTime: 12000, harvestReward: 20 },
            sunflower: { name: 'Sunflower', icon: 'üåª', rarity: 'uncommon', color: 'text-white', bgColor: 'bg-green-500', growthTime: 20000, harvestReward: 50 },
            rose: { name: 'Rose', icon: 'üåπ', rarity: 'uncommon', color: 'text-white', bgColor: 'bg-green-600', growthTime: 25000, harvestReward: 65 },
            oak: { name: 'Oak Tree', icon: 'üå≥', rarity: 'rare', color: 'text-white', bgColor: 'bg-blue-500', growthTime: 45000, harvestReward: 180 },
            lotus: { name: 'Lotus', icon: 'ü™∑', rarity: 'rare', color: 'text-white', bgColor: 'bg-blue-600', growthTime: 50000, harvestReward: 220 },
            phoenix: { name: 'Phoenix Flower', icon: '‚ö°', rarity: 'legendary', color: 'text-white', bgColor: 'bg-purple-600', growthTime: 90000, harvestReward: 500 },
            celestial: { name: 'Celestial Bloom', icon: '‚ú®', rarity: 'mythical', color: 'text-white', bgColor: 'gradient-bg-2', growthTime: 180000, harvestReward: 1500 }
        };

        const seedPacks = {
            basic: { name: 'Basic Seed Pack', cost: 10, icon: 'üì¶', color: 'text-gray-600', rarityRates: { common: 85, uncommon: 15, rare: 0, legendary: 0, mythical: 0 } },
            premium: { name: 'Premium Seed Pack', cost: 50, icon: 'üì¶', color: 'text-green-600', rarityRates: { common: 60, uncommon: 25, rare: 10, legendary: 4, mythical: 1 } },
            legendary: { name: 'Legendary Seed Pack', cost: 200, icon: 'üëë', color: 'text-purple-600', rarityRates: { common: 0, uncommon: 25, rare: 50, legendary: 20, mythical: 5 } }
        };

        const generatorTypes = {
            sprinkler: { name: 'Garden Sprinkler', icon: 'üíß', description: 'Automatically waters plants for extra nectar', color: 'text-blue-600', bgColor: 'bg-blue-100' },
            greenhouse: { name: 'Mini Greenhouse', icon: 'üè†', description: 'Controlled environment boosts nectar production', color: 'text-green-600', bgColor: 'bg-green-100' },
            beehive: { name: 'Magical Beehive', icon: 'üêù', description: 'Bees pollinate plants for premium nectar', color: 'text-yellow-600', bgColor: 'bg-yellow-100' },
            mysticwell: { name: 'Mystic Well', icon: 'üîÆ', description: 'Ancient magic continuously generates pure nectar', color: 'text-purple-600', bgColor: 'bg-purple-100' }
        };

        const sunlightShop = {
            golden_daisy: { name: 'Golden Daisy', icon: '‚≠ê', rarity: 'legendary', color: 'text-white', bgColor: 'gradient-bg-1', growthTime: 15000, harvestReward: 150, sunlightCost: 5 },
            rainbow_rose: { name: 'Rainbow Rose', icon: 'üåà', rarity: 'mythical', color: 'text-white', bgColor: 'gradient-bg-3', growthTime: 45000, harvestReward: 400, sunlightCost: 15 },
            starfruit_tree: { name: 'Starfruit Tree', icon: 'üëë', rarity: 'mythical', color: 'text-white', bgColor: 'gradient-bg-4', growthTime: 60000, harvestReward: 800, sunlightCost: 25 }
        };

        const milestones = [
            { plants: 5, sunlight: 1, description: "First Garden" },
            { plants: 10, sunlight: 2, description: "Growing Collection" },
            { plants: 25, sunlight: 5, description: "Plant Enthusiast" },
            { plants: 50, sunlight: 10, description: "Master Gardener" }
        ];

        // Utility Functions
        function formatTime(ms) {
            const seconds = Math.ceil(ms / 1000);
            if (seconds < 60) return `${seconds}s`;
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes}m ${remainingSeconds}s`;
        }

        function getRarityColor(rarity) {
            switch (rarity) {
                case 'common': return 'text-gray-600';
                case 'uncommon': return 'text-green-600';
                case 'rare': return 'text-blue-600';
                case 'legendary': return 'text-purple-600';
                case 'mythical': return 'text-yellow-600';
                default: return 'text-gray-600';
            }
        }

        function getGrowthProgress(slot) {
            if (!slot || !slot.plantedTime) return 0;
            const now = Date.now();
            const elapsed = now - slot.plantedTime;
            const plant = plantTypes[slot.type] || sunlightShop[slot.type];
            return Math.min((elapsed / plant.growthTime) * 100, 100);
        }

        function isReadyToHarvest(slot) {
            return slot && getGrowthProgress(slot) >= 100;
        }

        function getRemainingTime(slot) {
            if (!slot || !slot.plantedTime) return 0;
            const now = Date.now();
            const plant = plantTypes[slot.type] || sunlightShop[slot.type];
            const elapsed = now - slot.plantedTime;
            return Math.max(0, plant.growthTime - elapsed);
        }

        function getTotalPlantsCollected() {
            return Object.values(gameState.plantCollection).reduce((sum, count) => sum + count, 0);
        }

        function getTotalNectarPerSecond() {
            let total = 0;
            
            // Nectar from active plant slots
            Object.keys(gameState.activeSlots).forEach(slotId => {
                const slot = gameState.activeSlots[slotId];
                if (slot && (plantTypes[slot.type] || sunlightShop[slot.type])) {
                    const plant = plantTypes[slot.type] || sunlightShop[slot.type];
                    total += Math.floor(plant.harvestReward * 0.1 / 60);
                }
            });
            
            // Nectar from generators
            Object.entries(gameState.generators).forEach(([genType, gen]) => {
                if (gen.level > 0) {
                    total += gen.baseNectar * gen.level;
                }
            });
            
            return total;
        }

        function checkMilestones(totalPlants) {
            const unlockedMilestones = milestones.filter(m => totalPlants >= m.plants);
            const highestUnlocked = unlockedMilestones[unlockedMilestones.length - 1];
            
            if (highestUnlocked && highestUnlocked.plants > gameState.lastMilestoneReached) {
                const newSunlight = unlockedMilestones
                    .filter(m => m.plants > gameState.lastMilestoneReached)
                    .reduce((sum, m) => sum + m.sunlight, 0);
                
                gameState.sunlight += newSunlight;
                gameState.lastMilestoneReached = highestUnlocked.plants;
                showReward(`milestone_${highestUnlocked.plants}`);
            }
        }

        function rollForPlant(rarityRates) {
            const random = Math.random() * 100;
            let cumulative = 0;
            
            for (const [rarity, rate] of Object.entries(rarityRates)) {
                cumulative += rate;
                if (random <= cumulative) {
                    const plantsOfRarity = Object.entries(plantTypes).filter(([_, plant]) => plant.rarity === rarity);
                    if (plantsOfRarity.length > 0) {
                        const randomPlant = plantsOfRarity[Math.floor(Math.random() * plantsOfRarity.length)];
                        return randomPlant[0];
                    }
                }
            }
            
            const commonPlants = Object.entries(plantTypes).filter(([_, plant]) => plant.rarity === 'common');
            return commonPlants[0][0];
        }

        function showReward(rewardType) {
            const popup = document.getElementById('rewardPopup');
            const content = document.getElementById('rewardContent');
            const text = document.getElementById('rewardText');
            
            popup.classList.remove('hidden');
            
            if (rewardType.startsWith('milestone_')) {
                content.className = 'gradient-bg-1 rounded-xl p-6 shadow-2xl border-4 border-yellow-400';
                text.innerHTML = `
                    <div class="text-2xl font-bold mb-2">MILESTONE!</div>
                    <div class="text-4xl mb-2">‚≠ê</div>
                    <div class="text-xl font-bold">Sunlight Earned!</div>
                `;
            } else if (rewardType.startsWith('harvested_')) {
                const plantType = rewardType.replace('harvested_', '');
                const plant = plantTypes[plantType] || sunlightShop[plantType];
                content.className = 'bg-yellow-500 rounded-xl p-6 shadow-2xl border-4 border-yellow-400';
                text.innerHTML = `
                    <div class="text-2xl font-bold mb-2">HARVESTED!</div>
                    <div class="text-4xl mb-2">${plant.icon}</div>
                    <div class="text-xl font-bold">+${plant.harvestReward} Nectar</div>
                `;
            } else {
                const plant = plantTypes[rewardType] || sunlightShop[rewardType];
                content.className = `${plant.bgColor} rounded-xl p-6 shadow-2xl border-4 border-yellow-400`;
                text.innerHTML = `
                    <div class="text-2xl font-bold mb-2">NEW PLANT!</div>
                    <div class="text-4xl mb-2">${plant.icon}</div>
                    <div class="text-xl font-bold">${plant.name}</div>
                    <div class="text-sm opacity-90">${plant.rarity.toUpperCase()}</div>
                `;
            }
            
            setTimeout(() => {
                popup.classList.add('hidden');
            }, 3000);
        }

        // Game Actions
        function openSeedPack(packType) {
            const pack = seedPacks[packType];
            if (gameState.nectar < pack.cost || gameState.openingPack) return;

            gameState.nectar -= pack.cost;
            gameState.openingPack = packType;
            updateDisplay();

            setTimeout(() => {
                const newPlant = rollForPlant(pack.rarityRates);
                const emptySlots = Array.from({length: 12}, (_, i) => i + 1).filter(id => !gameState.activeSlots[id]);
                
                if (emptySlots.length > 0) {
                    const slotId = emptySlots[Math.floor(Math.random() * emptySlots.length)];
                    gameState.activeSlots[slotId] = { type: newPlant, plantedTime: Date.now() };
                }

                gameState.plantCollection[newPlant] = (gameState.plantCollection[newPlant] || 0) + 1;
                const totalPlants = getTotalPlantsCollected();
                setTimeout(() => checkMilestones(totalPlants), 100);

                showReward(newPlant);
                gameState.openingPack = null;
                updateDisplay();
            }, 1500);
        }

        function buySunlightPlant(plantKey) {
            const plant = sunlightShop[plantKey];
            if (gameState.sunlight < plant.sunlightCost) return;

            const emptySlots = Array.from({length: 12}, (_, i) => i + 1).filter(id => !gameState.activeSlots[id]);
            if (emptySlots.length === 0) return;

            gameState.sunlight -= plant.sunlightCost;
            
            const slotId = emptySlots[Math.floor(Math.random() * emptySlots.length)];
            gameState.activeSlots[slotId] = { type: plantKey, plantedTime: Date.now() };

            gameState.plantCollection[plantKey] = (gameState.plantCollection[plantKey] || 0) + 1;
            const totalPlants = getTotalPlantsCollected();
            setTimeout(() => checkMilestones(totalPlants), 100);

            showReward(plantKey);
            updateDisplay();
        }

        function buyGenerator(genType) {
            const gen = gameState.generators[genType];
            const currentCost = Math.floor(gen.cost * Math.pow(1.15, gen.level));
            
            if (gameState.nectar < currentCost) return;
            
            gameState.nectar -= currentCost;
            gameState.generators[genType].level += 1;
            updateDisplay();
        }

        function harvestPlant(slotId) {
            const slot = gameState.activeSlots[slotId];
            if (!slot || !isReadyToHarvest(slot)) return;

            const plant = plantTypes[slot.type] || sunlightShop[slot.type];
            gameState.nectar += plant.harvestReward;

            delete gameState.activeSlots[slotId];
            showReward(`harvested_${slot.type}`);
            updateDisplay();
        }

        function harvestAll() {
            Object.entries(gameState.activeSlots).forEach(([slotId, slot]) => {
                if (isReadyToHarvest(slot)) {
                    harvestPlant(slotId);
                }
            });
        }

        // Display Functions
        function updateDisplay() {
            // Update header displays
            document.getElementById('nectarDisplay').textContent = `${Math.floor(gameState.nectar)} Nectar`;
            document.getElementById('sunlightDisplay').textContent = `${gameState.sunlight} Sunlight`;
            document.getElementById('nectarPerSecDisplay').textContent = `+${getTotalNectarPerSecond()}/sec`;

            // Update milestone progress
            const totalPlants = getTotalPlantsCollected();
            const nextMilestone = milestones.find(m => totalPlants < m.plants);
            const milestoneDiv = document.getElementById('milestoneProgress');
            
            if (nextMilestone) {
                milestoneDiv.classList.remove('hidden');
                document.getElementById('milestoneText').textContent = `Next Milestone: ${nextMilestone.description}`;
                document.getElementById('milestoneProgress').textContent = `${totalPlants}/${nextMilestone.plants} plants (+${nextMilestone.sunlight} sunlight)`;
                document.getElementById('milestoneBar').style.width = `${Math.min((totalPlants / nextMilestone.plants) * 100, 100)}%`;
            } else {
                milestoneDiv.classList.add('hidden');
            }

            // Update tab content based on active tab
            if (gameState.activeTab === 'farm') {
                updateFarmDisplay();
            } else if (gameState.activeTab === 'generators') {
                updateGeneratorsDisplay();
            } else if (gameState.activeTab === 'collection') {
                updateCollectionDisplay();
            } else if (gameState.activeTab === 'shop') {
                updateShopDisplay();
            }

            updateTabButtons();
        }

        function updateTabButtons() {
            const readyCount = Object.values(gameState.activeSlots).filter(slot => isReadyToHarvest(slot)).length;
            const generatorNectar = Object.values(gameState.generators).reduce((sum, gen) => sum + (gen.baseNectar * gen.level), 0);
            const totalPlants = getTotalPlantsCollected();

            document.getElementById('farmTab').textContent = `Farm (${readyCount} ready)`;
            document.getElementById('generatorsTab').textContent = `Generators (+${generatorNectar}/sec)`;
            document.getElementById('collectionTab').textContent = `Collection (${totalPlants})`;
        }

        function updateFarmDisplay() {
            // Update garden slots
            const slotsContainer = document.getElementById('gardenSlots');
            slotsContainer.innerHTML = '';
            
            for (let i = 1; i <= 12; i++) {
                const slot = gameState.activeSlots[i];
                const slotDiv = document.createElement('div');
                slotDiv.className = 'w-20 h-20 rounded-lg flex flex-col items-center justify-center transition-all relative overflow-hidden cursor-pointer';
                
                if (!slot) {
                    slotDiv.className += ' bg-amber-100 border-2 border-dashed border-amber-300';
                    slotDiv.innerHTML = '<span class="text-amber-400 text-2xl">+</span>';
                } else {
                    const plant = plantTypes[slot.type] || sunlightShop[slot.type];
                    const progress = getGrowthProgress(slot);
                    const ready = isReadyToHarvest(slot);
                    const remainingTime = getRemainingTime(slot);
                    
                    slotDiv.className += ` ${plant.bgColor} ${ready ? 'animate-pulse ring-2 ring-yellow-400' : ''}`;
                    slotDiv.title = ready ? `${plant.name} - Ready to harvest!` : `${plant.name} - Growing... ${formatTime(remainingTime)} remaining`;
                    
                    let innerHTML = `<span class="${plant.color} text-2xl ${ready ? 'animate-bounce' : ''}">${plant.icon}</span>`;
                    
                    if (!ready) {
                        innerHTML += `
                            <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-20 h-2">
                                <div class="h-full bg-green-400 transition-all duration-1000" style="width: ${progress}%"></div>
                            </div>
                            <div class="text-xs text-white font-bold mt-1">${formatTime(remainingTime)}</div>
                        `;
                    } else {
                        innerHTML += '<div class="text-xs font-bold text-yellow-200 animate-pulse">READY!</div>';
                    }
                    
                    slotDiv.innerHTML = innerHTML;
                }
                
                slotsContainer.appendChild(slotDiv);
            }

            // Update harvest list
            const harvestList = document.getElementById('harvestList');
            const readySlots = Object.entries(gameState.activeSlots).filter(([_, slot]) => isReadyToHarvest(slot));
            
            if (readySlots.length === 0) {
                harvestList.innerHTML = '<div class="text-center text-gray-500 py-8">No plants ready to harvest yet. Check back soon!</div>';
                document.getElementById('harvestAllBtn').classList.add('hidden');
            } else {
                harvestList.innerHTML = readySlots.map(([slotId, slot]) => {
                    const plant = plantTypes[slot.type] || sunlightShop[slot.type];
                    return `
                        <div class="flex items-center gap-4 p-4 bg-yellow-50 rounded-lg border-2 border-yellow-200 hover:border-yellow-400 transition-all cursor-pointer" onclick="harvestPlant(${slotId})">
                            <div class="${plant.bgColor} w-16 h-16 rounded-lg flex items-center justify-center animate-pulse">
                                <span class="${plant.color} text-2xl">${plant.icon}</span>
                            </div>
                            <div class="flex-1">
                                <div class="font-bold text-lg">${plant.name}</div>
                                <div class="text-sm text-gray-600 capitalize">${plant.rarity}</div>
                                <div class="text-lg font-bold text-yellow-600">+${plant.harvestReward} Nectar</div>
                            </div>
                            <div class="text-yellow-500 font-bold text-xl animate-bounce">READY!</div>
                        </div>
                    `;
                }).join('');
                
                const harvestBtn = document.getElementById('harvestAllBtn');
                harvestBtn.classList.remove('hidden');
                harvestBtn.textContent = `Harvest All (${readySlots.length})`;
            }
        }

        function updateGeneratorsDisplay() {
            const generatorsList = document.getElementById('generatorsList');
            generatorsList.innerHTML = Object.entries(generatorTypes).map(([genKey, genData]) => {
                const gen = gameState.generators[genKey];
                const currentCost = Math.floor(gen.cost * Math.pow(1.15, gen.level));
                const canAfford = gameState.nectar >= currentCost;
                const nectarPerSec = gen.baseNectar * gen.level;
                
                return `
                    <div class="${genData.bgColor} rounded-xl p-6 border-2 ${canAfford ? 'border-gray-300' : 'border-gray-200'}">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-16 h-16 bg-white rounded-lg flex items-center justify-center shadow-md">
                                <span class="${genData.color} text-2xl">${genData.icon}</span>
                            </div>
                            <div>
                                <h3 class="text-xl font-bold text-gray-800">${genData.name}</h3>
                                <p class="text-sm text-gray-600">${genData.description}</p>
                            </div>
                        </div>
                        
                        <div class="space-y-2 mb-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700 font-medium">Level:</span>
                                <span class="font-bold text-lg">${gen.level}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-700 font-medium">Production:</span>
                                <span class="font-bold text-lg text-blue-600">+${nectarPerSec}/sec</span>
                            </div>
                            ${gen.level > 0 ? `
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-700 font-medium">Next level:</span>
                                    <span class="font-bold text-lg text-blue-600">+${gen.baseNectar}/sec</span>
                                </div>
                            ` : ''}
                        </div>
                        
                        <button onclick="buyGenerator('${genKey}')" ${!canAfford ? 'disabled' : ''} 
                                class="w-full py-3 px-4 rounded-lg font-bold text-lg transition-all ${canAfford ? 'bg-purple-600 hover:bg-purple-700 text-white cursor-pointer hover:shadow-md' : 'bg-gray-300 text-gray-500 cursor-not-allowed'}">
                            ${gen.level === 0 ? 'Build' : 'Upgrade'} - ${currentCost.toLocaleString()} Nectar
                        </button>
                    </div>
                `;
            }).join('');

            // Update generator summary
            const summary = document.getElementById('generatorSummary');
            const activeGenerators = Object.entries(generatorTypes).filter(([genKey]) => gameState.generators[genKey].level > 0);
            
            if (activeGenerators.length > 0) {
                summary.innerHTML = `
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Generator Summary</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        ${activeGenerators.map(([genKey, genData]) => {
                            const gen = gameState.generators[genKey];
                            const nectarPerSec = gen.baseNectar * gen.level;
                            return `
                                <div class="bg-white rounded-lg p-3 text-center">
                                    <div class="text-sm font-medium text-gray-600">${genData.name}</div>
                                    <div class="text-lg font-bold text-purple-600">Level ${gen.level}</div>
                                    <div class="text-sm text-blue-600">+${nectarPerSec}/sec</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                    <div class="mt-4 text-center">
                        <div class="text-lg font-bold text-gray-800">
                            Total Generator Production: <span class="text-purple-600">+${Object.values(gameState.generators).reduce((sum, gen) => sum + (gen.baseNectar * gen.level), 0)}/sec</span>
                        </div>
                    </div>
                `;
            } else {
                summary.innerHTML = `
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Generator Summary</h3>
                    <div class="text-center text-gray-500 py-8">No generators built yet. Purchase your first generator above!</div>
                `;
            }
        }

        function updateCollectionDisplay() {
            const collectionGrid = document.getElementById('collectionGrid');
            
            if (Object.keys(gameState.plantCollection).length === 0) {
                collectionGrid.innerHTML = '<p class="text-gray-500 text-center py-8 col-span-full">No plants collected yet. Open some seed packs!</p>';
            } else {
                collectionGrid.innerHTML = Object.entries(gameState.plantCollection)
                    .sort(([,a], [,b]) => b - a)
                    .map(([type, count]) => {
                        const plant = plantTypes[type] || sunlightShop[type];
                        if (!plant) return '';
                        return `
                            <div class="${plant.bgColor} rounded-lg p-4 text-center">
                                <span class="${plant.color} text-2xl block mb-2">${plant.icon}</span>
                                <div class="font-semibold text-white text-sm">${plant.name}</div>
                                <div class="text-lg font-bold text-white">√ó${count}</div>
                                <div class="text-xs text-white opacity-75">${plant.rarity}</div>
                            </div>
                        `;
                    }).join('');
            }
        }

        function updateShopDisplay() {
            // Update seed packs
            const seedPacksList = document.getElementById('seedPacksList');
            seedPacksList.innerHTML = Object.entries(seedPacks).map(([packType, pack]) => {
                const canAfford = gameState.nectar >= pack.cost;
                const isOpening = gameState.openingPack === packType;
                
                return `
                    <button onclick="openSeedPack('${packType}')" ${!canAfford || gameState.openingPack ? 'disabled' : ''}
                            class="w-full p-4 rounded-lg border-2 transition-all ${canAfford && !gameState.openingPack ? 'bg-white border-green-300 hover:border-green-500 hover:shadow-md cursor-pointer' : 'bg-gray-100 border-gray-300 cursor-not-allowed opacity-60'}">
                        <div class="flex items-center gap-4">
                            <div class="relative">
                                <span class="${pack.color} text-3xl">${pack.icon}</span>
                                ${isOpening ? '<div class="absolute inset-0 flex items-center justify-center"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-500"></div></div>' : ''}
                            </div>
                            <div class="flex-1 text-left">
                                <div class="font-bold text-lg">${pack.name}</div>
                                <div class="text-lg font-bold text-blue-600">${pack.cost} Nectar</div>
                                <div class="text-xs text-gray-500 flex gap-2 mt-1">
                                    ${Object.entries(pack.rarityRates).map(([rarity, rate]) => 
                                        rate > 0 ? `<span class="${getRarityColor(rarity)}">${rarity}: ${rate}%</span>` : ''
                                    ).join('')}
                                </div>
                            </div>
                        </div>
                    </button>
                `;
            }).join('');

            // Update sunlight shop
            const sunlightShopList = document.getElementById('sunlightShopList');
            sunlightShopList.innerHTML = Object.entries(sunlightShop).map(([plantKey, plant]) => {
                const canAfford = gameState.sunlight >= plant.sunlightCost;
                const emptySlots = Array.from({length: 12}, (_, i) => i + 1).filter(id => !gameState.activeSlots[id]);
                
                return `
                    <button onclick="buySunlightPlant('${plantKey}')" ${!canAfford || emptySlots.length === 0 ? 'disabled' : ''}
                            class="w-full p-3 rounded-lg border-2 transition-all ${canAfford && emptySlots.length > 0 ? 'bg-white border-yellow-300 hover:border-yellow-500 hover:shadow-md cursor-pointer' : 'bg-gray-100 border-gray-300 cursor-not-allowed opacity-60'}">
                        <div class="flex items-center gap-3">
                            <div class="${plant.bgColor} w-12 h-12 rounded-lg flex items-center justify-center">
                                <span class="${plant.color} text-xl">${plant.icon}</span>
                            </div>
                            <div class="flex-1 text-left">
                                <div class="font-bold text-md">${plant.name}</div>
                                <div class="text-md font-bold text-yellow-600">${plant.sunlightCost} Sunlight</div>
                                <div class="text-xs text-gray-500">+${plant.harvestReward} nectar</div>
                            </div>
                        </div>
                    </button>
                `;
            }).join('');
        }

        function switchTab(tabName) {
            // Hide all content
            document.getElementById('farmContent').classList.toggle('hidden', tabName !== 'farm');
            document.getElementById('generatorsContent').classList.toggle('hidden', tabName !== 'generators');
            document.getElementById('collectionContent').classList.toggle('hidden', tabName !== 'collection');
            document.getElementById('shopContent').classList.toggle('hidden', tabName !== 'shop');

            // Update tab buttons
            const tabs = ['farm', 'generators', 'collection', 'shop'];
            tabs.forEach(tab => {
                const button = document.getElementById(`${tab}Tab`);
                if (tab === tabName) {
                    button.className = `flex-1 py-4 px-6 text-lg font-semibold transition-colors bg-${tab === 'farm' ? 'yellow' : tab === 'generators' ? 'purple' : tab === 'collection' ? 'blue' : 'green'}-100 text-${tab === 'farm' ? 'yellow' : tab === 'generators' ? 'purple' : tab === 'collection' ? 'blue' : 'green'}-800 border-b-2 border-${tab === 'farm' ? 'yellow' : tab === 'generators' ? 'purple' : tab === 'collection' ? 'blue' : 'green'}-500`;
                } else {
                    button.className = `flex-1 py-4 px-6 text-lg font-semibold transition-colors text-gray-600 hover:text-${tab === 'farm' ? 'yellow' : tab === 'generators' ? 'purple' : tab === 'collection' ? 'blue' : 'green'}-600`;
                }
            });

            gameState.activeTab = tabName;
            updateDisplay();
        }

        // Event Listeners
        document.getElementById('farmTab').addEventListener('click', () => switchTab('farm'));
        document.getElementById('generatorsTab').addEventListener('click', () => switchTab('generators'));
        document.getElementById('collectionTab').addEventListener('click', () => switchTab('collection'));
        document.getElementById('shopTab').addEventListener('click', () => switchTab('shop'));
        document.getElementById('harvestAllBtn').addEventListener('click', harvestAll);

        // Game Loop
        setInterval(() => {
            const nectarGain = getTotalNectarPerSecond();
            if (nectarGain > 0) {
                gameState.nectar += nectarGain;
                updateDisplay();
            }
        }, 1000);

        // Update display every second for timers
        setInterval(() => {
            if (gameState.activeTab === 'farm') {
                updateFarmDisplay();
            }
        }, 1000);

    </script>
</body>
</html>
